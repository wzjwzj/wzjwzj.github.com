
<!DOCTYPE html>
<!--[if IE 7 ]>    <html lang="zh-CN" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="zh-CN" class="ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="zh-CN"> <!--<![endif]-->

<head>
  <meta charset="UTF-8">
  <!--[if IE 8 ]><meta http-equiv="X-UA-Compatible" content="IE=7"><![endif]-->

  <title>ABIC</title>
  
  
  <meta name="author" content="孤月谁明">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Favicon -->
  <link rel="shortcut icon" href="/favicon.ico">

  <!-- Feed -->
  <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml">
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">

  <!-- Styles -->
  <link rel="stylesheet" href="/assets/themes/twitter/css/style.min.css">
  <!--link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet"-->
  <link rel="stylesheet" href="/assets/font-awesome-4.0.3/css/font-awesome.min.css">
  <!--link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"-->
  <!--link rel="stylesheet" href="/assets/prettify/prettify.css"-->
  
  <!-- Scripts -->
  <script type="text/javascript" src="/assets/themes/twitter/js/jquery-1.10.1.min.js"></script>
  <script type="text/javascript" src="/assets/jquery-ui/js/jquery-ui-1.10.4.custom.min.js"></script>
  <link   rel="stylesheet"      href="/assets/jquery-ui/css/smoothness/jquery-ui-1.10.4.custom.min.css">

  	
   <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		config: ["MMLorHTML.js"],
		tex2jax: {
			inlineMath: [ ['$','$'], ['\\(','\\)'] ],
			displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
			processEscapes:true
  		},
  
  		jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
  		extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],
  		TeX: {
	  
			extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js","color.js","cancel.js"],
			equationNumbers: { autoNumber: "AMS" }
  		},
		styles: {
  			".MathJax_Display": {
    				"overflow-x": "auto",
    				"overflow-y": "hidden"
  			}
		}
	});
   </script>
   <script type='text/javascript' src='http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  

  

  

  

</head>

<body>

  <div id="wrap">
    <header id="top">
      <!-- Navigation Bar -->
      <nav id="navbar">
        <ul>
          
          <li>
            <a href="/" rel="nofollow" title="首页">首页</a>
          </li>
          <li>
            <a href="/archives.html" rel="nofollow" title="archives">归档</a>
          </li>
          <li>
            <a href="/messages.html" rel="nofollow" title="留言板">留言板</a>
          </li>
	  
	  <li>
	  <a href="/links.html" rel="nofollow" title="链接">链接</a>
	  </li>
	  
          <li>
            <a href="/about.html" rel="nofollow" title="关于">关于</a>
	  </li>

          <li>
	  <a href="/lino.html" rel="nofollow" title="便签">便签</a>
	  </li>

	  <li>
	  <a href="/gallery.html" rel="nofollow" title="相册">相册</a>
	  </li>

	  <li>
	  <a href="/slide.html" rel="nofollow" title="PPT">PPT</a>
	  </li>
	  
	  <li>
	  <a href="/docs/" rel="nofollow" title="docs">docs</a>
	  </li>

          <li>
            <a href="/rss.xml" rel="nofollow" title="订阅 RSS"><i class="fa fa-rss fa-2"></i></a>
          </li>
	  <li >
            <i id="icon-resize" class="fa fa-expand fa-2"></i>
          </li>
        </ul>
      </nav>
    </header>

    <section id="main">

      <!-- Sidebar -->
      <aside id="sidebar">
        <section id="search-box">
	 
<CENTER>
<!--img src="/assets/themes/twitter/img/google_search.png" border="0" alt="Google" align="absmiddle" style="padding-bottom:20px" /--> 
<!--FONT class='wdnx' ><B>惟德乃兴</B></FONT-->

<form  method="get" action="/gsearch.html">
  <input  type="text"   class="search-query" name="q"   placeholder="谷歌引擎搜索"></input>   
  <!--button type="submit" class="search-button" ><i class="icon-search"></i></button-->
</form>

<form  method="get" action="/search.html">
  <input  type="text"   class="search-query" name="q"   placeholder="站内正则搜索"></input>   
  <!--button type="submit" class="search-button" ><i class="icon-search"></i></button-->
</form>

<form  method="get" action="/dict.html">
  <input  type="text"   class="search-query" name="q"   placeholder="dict.cn 海词"></input>   
  <!--button type="submit" class="search-button" ><i class="icon-search"></i></button-->
</form>

<form id="glosbe" name="glosbe"  method="get" action="/glosbe.html"> 
  <input  type="text"   id="phrase"  name="phrase"  placeholder="dictionary" class="search-query">  
  <select name="from" onchange='set_item_from( )'>
    <option value="deu" >deutsch</option>
    <option value="eng" >english</option>
    <option value="zho" >汉语</option>
  </select>
  <select name="dest" onchange='set_item_dest( )' >
    <option value="zho">汉语</option>
    <option value="eng">english</option>
    <option value="deu">deutsch</option>
  </select> 
  <!--input  type="text"   id="phrase"  name="phrase"  placeholder="dictionary" class="search-query"-->  
  <!--button type="submit" class="search-button" ><i class="icon-search"></i></button-->
</form> 
<div id="keyboard" style="display:none; "> 
	<a href="javascript:addSpecChar('ä')" class="btn">ä</a> 
	<a href="javascript:addSpecChar('Ä')" class="btn">Ä</a> 
	<a href="javascript:addSpecChar('ö')" class="btn">ö</a> 
	<a href="javascript:addSpecChar('Ö')" class="btn">Ö</a> 
	<a href="javascript:addSpecChar('ü')" class="btn">ü</a> 
	<a href="javascript:addSpecChar('Ü')" class="btn">Ü</a> 
	<a href="javascript:addSpecChar('ß')" class="btn">ß</a> 
	<a href="javascript:addSpecChar('ẞ')" class="btn">ẞ</a> 
</div>
</CENTER>


<SCRIPT language=JavaScript>
  function showhidekeyboard(){
    if($('#glosbe select[name="from"]').val() == 'deu' ){
	$('#keyboard').css("display","inline-block");
    }else{
	$('#keyboard').css("display","none");
    }
  }
  if ( !sessionStorage.getItem("from") ) {  
	sessionStorage.setItem("from", "deu");
        $('#glosbe select[name="from"]').val("deu");
  }else{
	$('#glosbe select[name="from"]').val(sessionStorage.getItem("from"));
  }
  showhidekeyboard();
  if ( !sessionStorage.getItem("dest") ) {  
	sessionStorage.setItem("dest", "zho");
        $('#glosbe select[name="dest"]').val("zho");
  }else{
        $('#glosbe select[name="dest"]').val(sessionStorage.getItem("dest"));
  }
  function set_item_from( ){
	sessionStorage.setItem('from', $('#glosbe select[name="from"]').val());
	showhidekeyboard();
  }
  function set_item_dest( ){
	sessionStorage.setItem('dest', $('#glosbe select[name="dest"]').val());
  }
  function addSpecChar(NewCode) {
    document.glosbe.phrase.value += ''+NewCode+''; 
    var t=$("#phrase").val(); $("#phrase").val("").focus().val(t);
  };
</SCRIPT>


	</section>
	<section>
	 <div style="padding:22px 18px">
	 <a class=social style="background-image: url('/images/social/Icon_Seminar.jpg');"  target="_blank" href="http://seismo.geo.uni-potsdam.de/upseismo/wiki/SeminarTalks" title="Seminar Talks">social</a>
	 <a class=social style="background-image: url('/images/social/mail-icon.jpg');"  target="_blank" href="https://coesite.geo.uni-potsdam.de/src/login.php" title="Email Coesite">social</a>
	 <a class=social style="background-image: url('/images/social/calligraphy.png');"  target="_blank" href="/demos/calligraphy.html" title="每日一字">calligraphy</a>
	 <a class=social style="background-image: url('/images/social/gmt_nav.gif');"  target="_blank" href="http://gmt.soest.hawaii.edu/doc/5.1.0/index.html" title="gmt">gmt</a>
	 <a class=social style="background-image: url('/images/social/kiwi.png');"  target="_blank" href="http://kinherd.org/" title="kiwi tools">kiwi</a>
	 </div>
	</section>
	<!--toc>
	<div id="toc_wraper" style="display:none">
	<section>
	   <a href="#"><i class="fa fa-list fa-2"></i> 目录 </a>
	   <div class="toc">
	</section>
	</div-->
	
	<!--toc-->
	
	<section style="padding-top:1px">
	   <div id="toc_wraper" style="background-color:#FFF">
	     <a href="#"><i class="fa fa-list fa-2"></i> 目录 </a>
	     <div class="toc"></div>
	   </div>
	</section>
	

	<!--widget default include  -->
	
	   
  <section  class="active"><a href="/archive.html" title="查看所有文章"><i class="fa fa-file-text fa-2"></i> 最近发表</a>
<span title="文章总数">18</span>
<ul>

  <li><a href="/blog/2014/04/16/abic0" title="查看《ABIC0》">ABIC0</a></li>

  <li><a href="/blog/2014/03/03/ABIC" title="查看《ABIC》">ABIC</a></li>

  <li><a href="/blog/2014/02/25/chinese-food-recipe" title="查看《菜单》">菜单</a></li>

  <li><a href="/blog/2014/02/17/tar" title="查看《[转]tar 压缩解压缩命令详解》">[转]tar 压缩解压缩命令详解</a></li>

  <li><a href="/blog/2014/02/09/pjax" title="查看《[转]Pjax是什么以及为什么推荐大家用》">[转]Pjax是什么以及为什么推荐大家用</a></li>

  <li><a href="/blog/2014/02/08/nationalparks-in-deutschland" title="查看《测试谷歌地图:德国国家公园》">测试谷歌地图:德国国家公园</a></li>

  <li><a href="/blog/2014/01/20/kiwi_info" title="查看《kiwi_info》">kiwi_info</a></li>

  <li><a href="/blog/2014/01/14/smalltool" title="查看《small tools,widgets or applets list》">small tools,widgets or applets list</a></li>

  <li><a href="/blog/2014/01/12/haskell-on-ubuntu" title="查看《haskell on ubuntu》">haskell on ubuntu</a></li>

  <li><a href="/blog/2014/01/11/command_pool" title="查看《常用命令示例》">常用命令示例</a></li>

  <li><a href="/blog/2014/01/08/amssymbols" title="查看《AMSsymbols》">AMSsymbols</a></li>

  <li><a href="/blog/2013/12/18/build-repository-with-dropbox" title="查看《用dropbox虚拟github建立私有仓库》">用dropbox虚拟github建立私有仓库</a></li>

  <li><a href="/blog/2013/12/17/scripts" title="查看《一些示例脚本存档》">一些示例脚本存档</a></li>

  <li><a href="/blog/2013/12/15/test-self-def-input" title="查看《测试自定义输入》">测试自定义输入</a></li>

  <li><a href="/blog/2013/12/14/problems-refer-cygwin" title="查看《cygwin下个人使用过程中所遇问题汇总》">cygwin下个人使用过程中所遇问题汇总</a></li>

</ul>
</section>
  <section ><a href="/categories.html" title="查看所有分类"><i class="fa fa-folder-open fa-2"></i> 文章分类</a>
<span title="分类总数">8</span>
<ul>

  <li><a href="/categories.html#uncategorized-ref" rel="nofollow">uncategorized (8)</a></li>

  <li><a href="/categories.html#info-ref" rel="nofollow">info (5)</a></li>

  <li><a href="/categories.html#git-ref" rel="nofollow">git (1)</a></li>

  <li><a href="/categories.html#programming-ref" rel="nofollow">programming (1)</a></li>

  <li><a href="/categories.html#dropbox-ref" rel="nofollow">dropbox (1)</a></li>

  <li><a href="/categories.html#study-ref" rel="nofollow">study (1)</a></li>

  <li><a href="/categories.html#旅游-ref" rel="nofollow">旅游 (1)</a></li>

  <li><a href="/categories.html#unix-ref" rel="nofollow">unix (1)</a></li>

</ul>
</section>
  <section ><a href="/tags.html" title="查看所有标签"><i class="fa fa-tags fa-2"></i> 标签云</a>
<span title="标签总数">19</span>
<div id="tag-cloud">


  
  <a href="/tags.html#info-ref" rel="nofollow" style="font-size: 18pt; color: #000;">info</a>

  
  <a href="/tags.html#git-ref" rel="nofollow" style="font-size: 9pt; color: #999;">git</a>

  
  <a href="/tags.html#cygwin-ref" rel="nofollow" style="font-size: 9pt; color: #999;">cygwin</a>

  
  <a href="/tags.html#error-ref" rel="nofollow" style="font-size: 9pt; color: #999;">error</a>

  
  <a href="/tags.html#test-ref" rel="nofollow" style="font-size: 9pt; color: #999;">test</a>

  
  <a href="/tags.html#script-ref" rel="nofollow" style="font-size: 9pt; color: #999;">script</a>

  
  <a href="/tags.html#code-ref" rel="nofollow" style="font-size: 9pt; color: #999;">code</a>

  
  <a href="/tags.html#dropbox-ref" rel="nofollow" style="font-size: 9pt; color: #999;">dropbox</a>

  
  <a href="/tags.html#github-ref" rel="nofollow" style="font-size: 9pt; color: #999;">github</a>

  
  <a href="/tags.html#AMS-ref" rel="nofollow" style="font-size: 9pt; color: #999;">AMS</a>

  
  <a href="/tags.html#symbols-ref" rel="nofollow" style="font-size: 9pt; color: #999;">symbols</a>

  
  <a href="/tags.html#mathjax-ref" rel="nofollow" style="font-size: 9pt; color: #999;">mathjax</a>

  
  <a href="/tags.html#latex-ref" rel="nofollow" style="font-size: 9pt; color: #999;">latex</a>

  
  <a href="/tags.html#tex-ref" rel="nofollow" style="font-size: 9pt; color: #999;">tex</a>

  
  <a href="/tags.html#command-ref" rel="nofollow" style="font-size: 9pt; color: #999;">command</a>

  
  <a href="/tags.html#haskell-ref" rel="nofollow" style="font-size: 9pt; color: #999;">haskell</a>

  
  <a href="/tags.html#cabal-ref" rel="nofollow" style="font-size: 9pt; color: #999;">cabal</a>

  
  <a href="/tags.html#ghc-ref" rel="nofollow" style="font-size: 9pt; color: #999;">ghc</a>

  
  <a href="/tags.html#installation-ref" rel="nofollow" style="font-size: 9pt; color: #999;">installation</a>

</div>
</section>

  <!--section id="xiami" style="padding-top:10px; height:275px; overflow-y:hidden;"><script type="text/javascript" src="http://www.xiami.com/widget/player-multi?uid=30536045&sid=1771893720,1771286689,1771179817,1460646,3418644,2178964,1275039,&width=250&height=320&mainColor=aaaaaa&backColor=e6e6e6&autoplay=0&mode=js"></script>
</section-->

<div id="fixed-container">
  <section id="rlist"><a href="#"><i class="fa fa-code fa-2"></i> 代码仓库</a>
<ul>
  <li><a href="http://github.com/liberize/liberize.github.com">本博客源码</a></li>
  <!--
  <li><a href="http://github.com/liberize/rhythmbox-doubanfm-plugin">Rhythmbox 豆瓣 FM 插件</a></li>
  <li><a href="http://github.com/liberize/rhythmbox-osdlyrics-plugin">Rhythmbox 歌词插件</a></li>
  -->
</ul>
</section>
  <section id="llist"><a href="#"><i class="fa fa-link fa-2"></i> 友情链接</a>
<ul>
  <li><a href="https://github.com/Shopify/liquid/wiki/Liquid-for-Designers" target="_blank" rel="nofollow">Liquid 模板引擎</a></li>
  <li><a href="http://jekyllrb.com/" target="_blank" rel="nofollow">Jekyll 静态博客生成器</a></li>
</ul>
</section>
  <section id="clist"><a href="#"><i class="fa fa-heart fa-2"></i> 与我联系</a>
<div id="contacts-list">
  <a href="mailto:wzjwzj@mail.ustc.edu.cn" target="_blank" rel="nofollow" title="Gmail">
    <i class="fa fa-envelope fa-3"></i>
  </a>
  <a href="http://wzjwzj.github.io/" target="_blank" rel="nofollow" title="Github">
    <i class="fa fa-github fa-3"></i>
  </a>
  <a href="http://wzjwzj.github.io/" target="_blank" rel="nofollow" title="新浪微博">
    <i class="fa fa-weibo fa-3"></i>
  </a>
  <a href="https://sites.google.com/site/guyueshuiming/" target="_blank" rel="nofollow" title="Google+">
    <i class="fa fa-google-plus fa-3"></i>
  </a>
  <a href="http://wzjwzj.github.io/" target="_blank" rel="nofollow" title="Twitter">
    <i class="fa fa-twitter fa-3"></i>
  </a>
  <a href="http://wzjwzj.github.io/" target="_blank" rel="nofollow" title="Facebook">
    <i class="fa fa-facebook-square fa-3"></i>
  </a>
</div>
</section>
</div>


	
      </aside>
      <!-- Main Content -->
      <div id="main-inner">
        <div id="loader"><img src="/assets/themes/twitter/img/loading.gif" alt="请稍侯"></div>
        <div id="main-content">
          
<section id="content">
  <article class="post">

    <header>
      <h1>ABIC</h1>
    </header>

    <section>
      <div class="post-extra">
        <div class="pull-left">
	   <span>03 March 2014  <a href="https://github.com/wzjwzj/wzjwzj.github.com/edit/master/_posts/2014-03-03-ABIC.md">编辑本文</a></span>
        </div>
	
      </div>
      <a name="summary"></a>
<h2>summary</h2>

<div>$$
min: \left(d-Ha\right)^t E^{-1} (d-Ha)
$$</div>




<!--end_excerpt-->


<a name="Formula"></a>
<h2>Formula</h2>

<p><strong>forward modeling:</strong></p>

<div>$$
u_j\left(t\right)=\sum_{q=1}^2 \int_s G_{qj}^0\left(t,\xi\right)*\dot{D}_q^0\left(t,\xi\right)~d\xi +e_{bj}\left( t \right)
$$</div>


<ul>
<li><em>j</em>: station index.</li>
<li><em>q</em>: slip component, along <strong>strike</strong> and <strong>dip</strong> direction.</li>
<li>integration in space :  $ \int_s ~d\xi $</li>
<li>integration in time :  convolution operator *</li>
</ul>


<p><strong> suppose: </strong></p>

<div>$$
\dot{D}_q^0\left(t,\xi\right) \thickapprox \sum_{k=1}^K \sum_{l=1}^L a_{qkl}X_k\left(\xi\right)T_l\left(t-t_k\right)
$$</div>


<ul>
<li>$ X_k $ : basis functions for space.</li>
<li>$ T_l $ : basis functions for time</li>
<li>$ t_k $ : arrival time of rupture front at grid k.</li>
<li>Note : we just convert to estimating $ a_{qkl} $
       there is no need to be orthogonal basis, here adopt Bézier basis functions.
       so the shape can be control by neibourhood grid which favor applying smoothing constrians.</li>
</ul>


<hr />

<div>$$
\begin{aligned}

u_j\left(t\right)&=\sum_{q=1}^2 \int_s G_{qj}^0\left(t,\xi\right)*  \color{red}{ \dot{D}_q^0\left(t,\xi\right) } \color{black}{~d\xi + e_{bj}\left( t \right)} \\
                 &=\sum_{q=1}^2 \int_s G_{qj}^0\left(t,\xi\right)*  \color{red}{ \sum_{k=1}^K \sum_{l=1}^L a_{qkl}X_k\left(\xi\right)T_l\left(t-t_k\right)} \color{black}{~d\xi +e_{bj}\left( t \right)}\\
                 &=\sum_{q=1}^2  \sum_{k=1}^K \sum_{l=1}^L a_{qkl} T_l\left(t-t_k\right) * \color{red}{ \int_s  X_k\left(\xi\right)G_{qj}^0\left(t,\xi\right) ~d\xi} \color{black}{+e_{bj}\left( t \right)}\\
                 &=\sum_{q=1}^2 \sum_{k=1}^K \sum_{l=1}^L a_{qkl} T_l \left( t - t_k \right) * \color{red}{ g_{qkj}^0\left( t \right)} \color{black}{+e_{bj}\left( t \right)} \\

\end{aligned}
$$</div>


<p>with</p>

<script type="math/tex; mode=display">
 g_{qkj}^0\left( t \right) = \int_s X_k \left( \xi \right) G_{qj}^0\left(t,\xi\right) ~d\xi
</script>


<p><em>$X_k$ is analytical expression, but $g_{qkj}$ is not. so there still exist error raised from the discretization</em></p>

<p><strong>if Consider uncertain of Green Function then:</strong></p>

<script type="math/tex; mode=display">
g_{qkj}^0\left( t \right) = g_{qkj}  \left( t \right) + \delta g_{qkj} \left( t \right) 
</script>




<script type="math/tex; mode=display">
\begin{aligned}

u_j \left( t \right) & = \sum_{q=1}^2 \sum_{k=1}^K 
                       \left[  
                          \sum_{l=1}^L \bbox[#eee]{ T_l\left(t-t_k\right)*g_{qkj}\left( t \right) } { \color{red} a_{qkl} } + 
                          \bbox[#eee]{  \sum_{l=1}^L a_{qkl}T_l\left(t-t_k\right)}  * \color{red} \delta g_{qkj} \left( t \right) 
                       \right] 
                     + e_{bj}\left( t \right) \\

          & = \sum_{q=1}^2 \sum_{k=1}^K \sum_{l=1}^L \bbox[#eee]{ \widetilde{H}_{qklj}\left(t\right) } { \color{red} a_{qkl} }   +  
      \left[  \sum_{q=1}^2 \sum_{k=1}^K \bbox[#eee]{ \widetilde{P}_{qk}\left(t,a_{qkl}\right)} * { \color{red} \delta g_{qkj} ( t ) } + e_{bj}( t ) \right] 
\end{aligned}
</script>


<p><strong>apply filter $B(t)$ </strong></p>

<script type="math/tex; mode=display">
\begin{aligned}
d_j \left( t \right) & = B\left(t\right) * u_j\left( t\right) \\
             & = \sum_{q=1}^2 \sum_{k=1}^K 
                       \left[  
                          \sum_{l=1}^L \bbox[#eee]{ B\left(t\right)*T_l\left(t-t_k\right)*g_{qkj}\left( t \right) } { \color{red} a_{qkl}}    + 
                          \bbox[#eee]{  \sum_{l=1}^L B\left(t\right)*a_{qkl}T_l\left(t-t_k\right)}  * { \color{red} \delta g_{qkj} \left( t \right) }
                       \right] 
                     + B\left(t\right)*e_{bj}\left( t \right) \\
             & = \sum_{q=1}^2 \sum_{k=1}^K \sum_{l=1}^L \bbox[#eee]{ B\left(t\right)*\widetilde{H}_{qklj}\left(t\right) }  { \color{red} a_{qkl}}    + 
                  \left[ \sum_{q=1}^2 \sum_{k=1}^K   \bbox[#eee]{  B\left(t\right)*\widetilde{P}_{qk}\left(t,a_{qkl}\right)} * { \color{red} \delta g_{qkj} \left( t \right) } + B\left(t\right)*e_{bj}\left( t \right) \right] \\
             & = \sum_{q=1}^2 \sum_{k=1}^K \sum_{l=1}^L \bbox[#eee]{ H_{qklj}\left(t\right) }  {\color{red} a_{qkl}}    + 
                  \left[ \sum_{q=1}^2 \sum_{k=1}^K  \bbox[#eee]{  P_{qk}\left(t,a_{qkl}\right)} * {\color{red} \delta g_{qkj} \left( t \right) } + B\left(t\right)*e_{bj}\left( t \right) \right]
        
\end{aligned}
</script>


<hr />

<script type="math/tex; mode=display">
\begin{aligned}
\mathbf{d}_j &= \mathbf{H}_j\mathbf{a}+\mathbf{e}_j(\mathbf{a}) \\
with &: \\
\mathbf{e}_j(\mathbf{a}) &= \sum_{q=1}^2 \sum_{k=1}^K \mathbf{P}_{qkj}(\mathbf{a})  \delta \mathbf{g}_{qkj}  + \mathbf{B}_j\mathbf{e}_{bj}
\end{aligned}
</script>


<hr />

<p><strong>if apply $ \delta G $ on initial G instead on $ g_{qkj}^0 $ then:</strong>(reverse derive)</p>

<script type="math/tex; mode=display">
\begin{aligned}
\widetilde{e}_j(t;a) & = \sum_{q=1}^2 \sum_{k=1}^K 
           \bbox[#eee]{  P_{qk}\left(t,a_{qkl}\right)} * { \color{red} \delta g_{qkj} \left( t \right) }
           + B\left(t\right)*e_{bj}\left( t \right) \\
      & = \sum_{q=1}^2 \sum_{k=1}^K 
            \bbox[#eee]{  B\left(t\right)*\widetilde{P}_{qk}\left(t,a_{qkl}\right)} * {\color{red} \delta g_{qkj} \left( t \right) }
          + B\left(t\right)*e_{bj}\left( t \right) \\
          &=\bbox[#eee]{ \sum_{q=1}^2 \sum_{k=1}^K 
            \bbox[#fee]{  \sum_{l=1}^L B\left(t\right)*a_{qkl}T_l\left(t-t_k\right)}  * {\color{red} \delta g_{qkj} \left( t \right) }
           + B\left(t\right)*e_{bj}\left( t \right)} \\
      &=\bbox[#eee]{\sum_{q=1}^2 \sum_{k=1}^K 
           \bbox[#fee]{  \sum_{l=1}^L B\left(t\right)*a_{qkl}T_l\left(t-t_k\right)}  * {\color{red} \int_s X_k \left( \xi \right)   \delta G_{qj}\left(t,\xi\right) ~d\xi }
           + B\left(t\right)*e_{bj}\left( t \right)} \\
      &=B\left(t\right)  * \sum_{q=1}^2 {\color{red} \int_s \sum_{k=1}^K 
            \sum_{l=1}^L   a_{qkl} X_k \left( \xi \right) T_l\left(t-t_k\right) * \delta G_{qj}\left(t,\xi\right) ~d\xi }
           + B\left(t\right)*e_{bj}\left( t \right) \\
      &=B\left(t\right)  * \sum_{q=1}^2 {\color{red} \int_s \dot{D}_q^0\left(t,\xi\right) * \delta G_{qj}\left(t,\xi\right) ~d\xi }
           + B\left(t\right)*e_{bj}\left( t \right) \\
\end{aligned}
</script>


<hr />

<a name="Propagation.of.uncertainty"></a>
<h2>Propagation of uncertainty</h2>

<p><strong><a href="http://en.wikipedia.org/wiki/Variance-covariance_matrix">variance-covariance matrix</a> </strong></p>

<script type="math/tex; mode=display">
\begin{aligned}

\Sigma_{ij} &= \mathrm{cov}(X_i, X_j) = \mathrm{E}\begin{bmatrix}
(X_i - \mu_i)(X_j - \mu_j)\\
\end{bmatrix} \\

&= \begin{bmatrix}
 \mathrm{E}[(X_1 - \mu_1)(X_1 - \mu_1)] & \mathrm{E}[(X_1 - \mu_1)(X_2 - \mu_2)] & \cdots & \mathrm{E}[(X_1 - \mu_1)(X_n - \mu_n)] \\ \\
 \mathrm{E}[(X_2 - \mu_2)(X_1 - \mu_1)] & \mathrm{E}[(X_2 - \mu_2)(X_2 - \mu_2)] & \cdots & \mathrm{E}[(X_2 - \mu_2)(X_n - \mu_n)] \\ \\
 \vdots & \vdots & \ddots & \vdots \\ \\
 \mathrm{E}[(X_n - \mu_n)(X_1 - \mu_1)] & \mathrm{E}[(X_n - \mu_n)(X_2 - \mu_2)] & \cdots & \mathrm{E}[(X_n - \mu_n)(X_n - \mu_n)]
\end{bmatrix} \\

&= \begin{pmatrix}
   \sigma^2_1 & \text{cov}_{12} & \text{cov}_{13} & \cdots \\
   \text{cov}_{12} & \sigma^2_2 & \text{cov}_{23} & \cdots\\
   \text{cov}_{13} & \text{cov}_{23} & \sigma^2_3 & \cdots \\
   \vdots & \vdots & \vdots & \ddots \\
\end{pmatrix} \\


\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
f_k &= \sum_i^n A_{ki} x_i  , (k=1\dots m); \mathbf{f} =\mathbf{A_{mn}x}  \\
\Sigma^f_{ij}&= \sum_k^n \sum_\ell^n A_{ik} \Sigma^x_{k\ell} A_{j\ell} \\
\Sigma^f&=\mathbf{A} \Sigma^x \mathbf{A}^\top \\
\Sigma^f_{ij}&= \sum_k^n  A_{ik} \left(\sigma^2_k \right)^x A_{jk}
\end{aligned}
</script>


<p><strong><a href="http://en.wikipedia.org/wiki/Toeplitz_matrix">Discrete convolution</a></strong></p>

<script type="math/tex; mode=display">

        y = h \ast x =
            \begin{bmatrix}
                h_1 & 0 & \ldots & 0 & 0 \\
                h_2 & h_1 & \ldots & \vdots & \vdots \\
                h_3 & h_2 & \ldots & 0 & 0 \\
                \vdots & h_3 & \ldots & h_1 & 0 \\
                h_{m-1} & \vdots & \ldots & h_2 & h_1 \\
                h_m & h_{m-1} & \vdots & \vdots & h_2 \\
                0 & h_m & \ldots & h_{m-2} & \vdots \\
                0 & 0 & \ldots & h_{m-1} & h_{m-2} \\
                \vdots & \vdots & \vdots & h_m & h_{m-1} \\
                0 & 0 & 0 & \ldots & h_m
            \end{bmatrix}
            \begin{bmatrix}
                x_1 \\
                x_2 \\
                x_3 \\
                \vdots \\
                x_n
            \end{bmatrix}
</script>


<a name="B..zier.curve"></a>
<h2><a href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve">Bézier curve</a></h2>

<a name="recursion.formula"></a>
<h3>recursion formula</h3>

<script type="math/tex; mode=display">
\begin{aligned}
B_{j,0}(x) &:= \left\{
\begin{matrix} 
1 & \mathrm{if} \quad t_j \leq x < t_{j+1} \\
0 & \mathrm{otherwise} 
\end{matrix}\right. \\
B_{i,k}(x) &:= \frac{x - t_i}{t_{i+k-1} - t_i} B_{i,k-1}(x) + \frac{t_{i+k} - x}{t_{i+k} - t_{i+1}} B_{i+1,k-1}(x).
\end{aligned}
</script>


<a name="General.form.of.a.NURBS.surface"></a>
<h3>General form of a NURBS surface</h3>

<p>A NURBS surface is obtained as the tensor product of two NURBS curves, thus using two independent parameters u and v (with indices i and j respectively):</p>

<script type="math/tex; mode=display">
S(u,v) = \sum_{i=1}^k \sum_{j=1}^l R_{i,j}(u,v) \mathbf{P}_{i,j} 
</script>


<p>with</p>

<script type="math/tex; mode=display">
R_{i,j}(u,v) = \frac {N_{i,n}(u) N_{j,m}(v) w_{i,j}} {\sum_{p=1}^k \sum_{q=1}^l N_{p,n}(u) N_{q,m}(v) w_{p,q}}
</script>


<p>as rational basis functions.</p>

<a name="simple.introduction.of.Bayesian.rule"></a>
<h2>simple introduction of Bayesian rule</h2>

<p>Joint probability of two events A and B:</p>

<script type="math/tex; mode=display">
P\left(AB\right) = P\left(A|B\right)P\left(B\right)=P\left(B|A\right)P\left(A\right)
</script>


<p>In Bayesian probablity theory: one &ldquo;events&rdquo; is <font color=red>H</font>ypothesis. the other is <font color=red>D</font>ata. so:</p>

<script type="math/tex; mode=display">
P\left(H|D\right) = \frac{P\left(D|H\right)P\left(H\right)}{P\left(D\right)}
</script>


<ul>
<li>$P\left(D|H\right)$: likelihood function, as it assesses the probablity of the observed data arising from hypothesis.</li>
<li>$P\left(H\right)$: prior, as it reflects one&prime; prior knowledge before the data are considered.</li>
<li>$P\left(H|D\right)$: Posterior, as its name suggests. reflects the probability of the hypothesis after consideration.</li>
</ul>


<p><strong>A simple example</strong></p>

<p>let&prime;s say we have some quantity in the world, $x$, and our observation of this quantity,$y$, is corrupted by additive Gaussian noise, e:</p>

<script type="math/tex; mode=display">
y=x+e, \quad e ~ \left(0, \sigma^2\right)
</script>


<ul>
<li>we might want to pick the value of $x$ that maximizes this distribution</li>
</ul>


<script type="math/tex; mode=display">
\widehat{x} = arg\,\underset{x}{min}\,P\left(x|y\right)
</script>


<p></p>

<ul>
<li>alternatively, we may want minimize the mean squared error of our guesses, then we should pick the mean of (Px|y);</li>
</ul>


<script type="math/tex; mode=display">
\widehat{x} = \int x P\left(x|y\right)~dx
</script>


<p></p>

<p>let&prime;s draw upon our existing knowledge. x with mean of 12,variance of 1. Thus,</p>

<script type="math/tex; mode=display">
\begin{aligned}
P\left(x|y\right) &= \frac{P\left(y|x\right)P\left(x\right)}{P\left(y\right)} \\
P\left(y|x\right) &= \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{\left(y-x\right)^2}{2\sigma^2}} \\
P\left(x\right)   &= \frac{1}{2\pi}e^{-\frac{\left(x-12\right)^2}{2}}\\
P\left(x|y\right) &\varpropto  e^{-\frac{\left(y-x\right)^2}{2\sigma^2}}e^{-\frac{\left(x-12\right)^2}{2}}
\end{aligned}
</script>


<p>The x which maximizes $P(x|y)$ is the same as that which minimizes the exponent in
brackets which may be found by simple algebraic manipulation to be:</p>

<script type="math/tex; mode=display">
\widehat{x}=\frac{\mathbf{y}+12\sigma^2}{1+\sigma^2}
</script>


<hr />

<a name="normalized.bicubic.B-splines"></a>
<h2>normalized bicubic B-splines</h2>

<script type="math/tex; mode=display">
\Phi_{kl}\left(\xi_1,\xi_2\right)=N_k\left(\xi_1\right)N_l\left(\xi_2\right)\qquad \left(k=1,...,K;l=1,...,L\right)
</script>


<p>where</p>

<script type="math/tex; mode=display">
N_j\left(s\right)=4 \Delta s M_{4,j+2}\left(s\right)
</script>


<p>which $ M_{4,j}(s) $ is the B-spline function of order 4(degree 3)</p>

<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
M_{1,j}\left(s\right) &=
  \begin{cases}
    1/\Delta s & \left( s_j - \Delta s  \leq  s               \lt    s_j \right) \\
    0         & \left( s               \lt   s_j - \Delta s ; s_j \leq   s   \right) 
  \end{cases} \\  

M_{r,j}\left( s \right) &= \frac{1}{ r \Delta s} \left\{ \cancelto{ \left( s-s_{j-r} \right) }{ \left[   s-s_j+\left( j-r \right) \Delta s  \right] } M_{r-1,j-1}\left( s \right) + \left( s_j - s \right) M_{r-1,j}\left( s \right) \right\}
\end{aligned}
\end{equation}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
M_{1,j}\left(s\right) &=
  \begin{cases}
    1/\Delta s & \left( s_j - \Delta s  \leq  s               \lt    s_j \right) \\
    0         & \left( s               \lt   s_j - \Delta s ; s_j \leq   s   \right) 
  \end{cases} \\  
M_{r,j}\left( s \right) &= \frac{1}{ r \Delta s} \left\{ \left( s-s_{j-r}  \right) M_{r-1,j-1}\left( s \right) + \left( s_j - s \right) M_{r-1,j}\left( s \right) \right\} 
\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
\Delta s M_{1,j}\left(s\right) &=
  \begin{cases}
    1          & \left( s_{j-1}  \leq  s    \lt    s_j \right) \\
    0          & \left( s        \lt   s_{j-1} ;   s_j  \leq   s   \right) 
  \end{cases} \\  
2 \Delta s^2 M_{2,j}\left( s \right) &= 
  \begin{cases}
    \left( s-s_{j-2}\right) & \left( s_{j-2}  \leq  s   \lt    s_{j-1} \right) \\
    \left( s_j-s   \right)  & \left( s_{j-1}  \leq  s   \lt    s_j \right) \\
    0          & \left( s        \lt   s_{j-2} ;  s_j \leq   s   \right) 
  \end{cases} \\  
6 \Delta s^3 M_{3,j}\left( s \right) &= 
  \begin{cases}
    \left( s-s_{j-3}\right)^2                             & \left( s_{j-3}  \leq  s   \lt    s_{j-2}   \right) \frac{ 1}{3}\Delta s^3 \\
    \left( s-s_{j-3}\right)\left(s_{j-1}-s\right)
   +\left( s_j-s \right)\left(s-s_{j-2}\right)            & \left( s_{j-2}  \leq  s   \lt    s_{j-1}   \right) \frac{ 4}{3}\Delta s^3 \\
    \left( s_j-s   \right)^2                              & \left( s_{j-1}  \leq  s   \lt    s_j \quad \right) \frac{ 1}{3}\Delta s^3 \\
    0          & \left( s        \lt   s_{j-3} ;  s_j \leq   s   \right) 
  \end{cases} \\  
24 \Delta s^4 M_{4,j}\left( s \right) &= 
  \begin{cases}
    \left( s-s_{j-4}\right)^3                                     & \left( s_{j-4}  \leq  s   \lt    s_{j-3} \right) \\
    \left( s - s_{j-4}\right)^2 \left(s_{j-2} - s\right) +
    \left( s - s_{j-4}\right)   \left(s_{j-1} - s\right)    \left(s - s_{j-3}\right) +
    \left( s_j-s \right)        \left(s-s_{j-3}\right)^2          & \left( s_{j-3}  \leq  s   \lt    s_{j-2} \right) \\
    \left( s-s_{j-4}\right)     \left(s_{j-1}-s\right)^2 +
    \left( s_j - s \right)      \left(s - s_{j-3}\right)    \left(s_{j-1} - s\right) + 
    \left( s_j - s \right)^2    \left(s - s_{j-2}\right)          & \left( s_{j-2}  \leq  s   \lt    s_{j-1} \right) \\
    \left( s_j - s \right)^3  & \left( s_{j-1}  \leq  s   \lt    s_j \right) \\
    0          & \left( s        \lt   s_{j-4} ;  s_j \leq   s   \right) 
  \end{cases} \\  
 &= 
  \begin{cases}
    \left( 2\Delta s - \left( s_{j-2}-s \right)\right)^3                                 & \left( s_{j-4} \leq s \lt s_{j-3} \right) \frac{ 1}{4}\Delta s^4 \\
    3 \left( s_{j-2}-s \right)^3 -6 \Delta s \left( s_{j-2}-s \right)^2  + 4 \Delta s^3  & \left( s_{j-3} \leq s \lt s_{j-2} \right) \frac{11}{4}\Delta s^4 \\
    3 \left( s-s_{j-2} \right)^3 -6 \Delta s \left( s-s_{j-2} \right)^2  + 4 \Delta s^3  & \left( s_{j-2} \leq s \lt s_{j-1} \right) \frac{11}{4}\Delta s^4 \\
    \left( 2\Delta s - \left( s-s_{j-2}\right)\right)^3                                  & \left( s_{j-1} \leq s \lt s_j\quad \right) \frac{ 1}{4}\Delta s^4 \\
    0          & \left( s        \lt   s_{j-4} ;  s_j \leq   s   \right) 
  \end{cases} \\  
\end{aligned}
</script>


<p><br/><br/></p>

<script type="math/tex; mode=display">
\definecolor{rgb}{RGB}{220,220,220}
\begin{aligned}
24 \Delta s^4 M_{4,j+2}\left( s \right) &= 
  \begin{cases}
    \left( s-s_{j-2}\right)^3                                     & \left( s_{j-2}  \leq  s   \lt    s_{j-1} \right) \\
    \left( s - s_{j-2}\right)^2 \left(s_j - s\right) +
    \left( s - s_{j-2}\right)   \left(s_{j+1} - s\right)    \left(s - s_{j-1}\right) +
    \left( s_{j+2}-s \right)        \left(s-s_{j-1}\right)^2          & \left( s_{j-1}  \leq  s   \lt    s_j \right) \\
    \left( s-s_{j-2}\right)     \left(s_{j+1}-s\right)^2 +
    \left( s_{j+2} - s \right)      \left(s - s_{j-1}\right)    \left(s_{j+1} - s\right) + 
    \left( s_{j+2} - s \right)^2    \left(s - s_j\right)          & \left( s_j  \leq  s   \lt    s_{j+1} \right) \\
    \left( s_{j+2} - s \right)^3  & \left( s_{j+1}  \leq  s   \lt    s_{j+2} \right) \\
    0          & \left( s        \lt   s_{j-2} ;  s_{j+2} \leq   s   \right) 
  \end{cases} \\  
 &= 
  \begin{cases}
    \left( s-s_{j-2}\right)^3   \color{rgb}{= \left( 2\Delta s - \left( s_j-s \right)\right)^3} & \left( s_{j-2} \leq s \lt s_{j-1} \right) \frac{ 1}{4}\Delta s^4  \\
    3 \left( s_j-s \right)^3 -6 \Delta s \left( s_j-s \right)^2  + 4 \Delta s^3      & \left( s_{j-1} \leq s \lt s_j \quad \right) \frac{11}{4}\Delta s^4 \\
    3 \left( s-s_j \right)^3 -6 \Delta s \left( s-s_j \right)^2  + 4 \Delta s^3      & \left( s_j \leq s \lt s_{j+1} \quad \right) \frac{11}{4}\Delta s^4 \\
    \left( s_{j+2} - s \right)^3\color{rgb}{= \left( 2\Delta s - \left( s-s_j\right)\right)^3} & \left( s_{j+1} \leq s \lt s_{j+2}\quad \right) \frac{ 1}{4}\Delta s^4  \\
    0          & \left( s        \lt   s_{j-2} ;  s_{j+2} \leq   s   \right) 
  \end{cases} \\  

24 \Delta s^4 \frac{  \partial M_{4,j+2}\left( s \right) }{\partial s} &= 
  \begin{cases}
   \enspace \,   3(s-s_{j-2})^2                        & \left( s_{j-2}  \leq  s   \lt    s_{j-1} \right) \\
      -9(s_j-s)^2+12\Delta s (s_j-s)         & \left( s_{j-1}  \leq  s   \lt    s_j \right) \\
   \enspace \,   9(s-s_j)^2-12\Delta s (s-s_j)         & \left( s_j  \leq  s   \lt    s_{j+1} \right) \\
      -3(s_{j+2}-s)^2                        & \left( s_{j+1}  \leq  s   \lt    s_{j+2} \right) \\
   \enspace \,  0                                     & \left( s        \lt   s_{j-2} ;  s_{j+2} \leq   s   \right) 
  \end{cases} \\  
24 \Delta s^4 \frac{  \partial^2 M_{4,j+2}\left( s \right) }{\partial s^2} &= 
  \begin{cases}
  \enspace 6(s-s_{j-2})    & \left( s_{j-2} \leq s \lt s_{j-1} \right)  \\
    18(s_j-s)-12 \Delta s  & \left( s_{j-1} \leq s \lt s_j \quad \right)  \\
    18(s-s_j)-12 \Delta s  & \left( s_j \leq s \lt s_{j+1} \quad \right)  \\
  \enspace 6(s_{j+2}-s)    & \left( s_{j+1} \leq s \lt s_{j+2}\quad \right)  \\
  \enspace 0               & \left( s  \lt   s_{j-2} ;  s_{j+2} \leq   s   \right) 
  \end{cases} \\

\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
\int M_{n,j}(s)~ds=\frac{1}{n}  
\end{aligned}
</script>


<p><figure class="one">
    <img style="border: none;" src="/images/figures/2014030301.png">
    <figcaption><span style="color:red">Red:M4;</span><span style="color:green">Green: first derivative;</span><span style="color:blue">Blue: second derivative</span></figcaption>
</figure></p>

<p><strong>value of center point</strong></p>

<script type="math/tex; mode=display">
\begin{aligned}
M^c_{1,j}\left( s_j-0.5\Delta s \right) &= 1/\Delta s\\
M^c_{2,j}\left( s_j-1.0\Delta s \right) &= 1/2\Delta s\\
M^c_{3,j}\left( s_j-1.5\Delta s \right) &= 1/4\Delta s\\
M^c_{4,j}\left( s_j-2.0\Delta s \right) &= 1/6\Delta s\\
\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{matrix}
      &       &       &       &       & 1      & 0     & \quad\frac{1}{1!\Delta s} & M_{1,j}     \\
      &       &       &       & 0     & 1      & 0     & \quad\frac{1}{2!\Delta s} & M_{2,j}     \\
      &       &       & 0     & 1     & 1      & 0     & \quad\frac{1}{3!\Delta s} & M_{3,j}     \\
      &       &   0   & 1     & 4     & 1      & 0     & \quad\frac{1}{4!\Delta s} & M_{4,j}     \\
      &   0   &   1   & 11    & 11    & 1      & 0     & \quad\frac{1}{5!\Delta s} & M_{5,j}     \\
    0 &   1   &   26  & 66    & 26    & 1      & 0     & \quad\frac{1}{6!\Delta s} & M_{6,j}     \\
s_{j-6} & s_{j-5} & s_{j-4} & s_{j-3} & s_{j-2} & s_{j-1}  & s_{j}   &             &             \\
\end{matrix}
</script>


<p><strong>value of grid</strong></p>

<script type="math/tex; mode=display">
\begin{matrix}
    &     &      &      &      & 1_1  & 0_0  & \quad\frac{1}{1!\Delta s} & M_{1,j}     \\
    &     &      &      & 1_0  & 0_1  &      &              &                                    \\
    &     &      &      & 0_2  & 1_1  & 0_0  & \quad\frac{1}{2!\Delta s} & M_{2,j}     \\
    &     &      & 0_0  & 1_1  & 0_2  &      &              &                                    \\
    &     &      & 0_2  & 1_2  & 1_1  & 0_0  & \quad\frac{1}{3!\Delta s} & M_{3,j}     \\
    &     & 0_0  & 1_1  & 1_2  & 0_3  &      &              &                                    \\
    &     & 0_4  & 1_3  & 4_2  & 1_1  & 0_0  & \quad\frac{1}{4!\Delta s} & M_{4,j}     \\
    & 0_0 & 1_1  & 4_2  & 1_3  & 0_4  &      &              &                                    \\
    & 0_5 & 1_4  & 11_3 & 11_2 & 1_1  & 0_0  & \quad\frac{1}{5!\Delta s} & M_{5,j}     \\
0_0 & 1_1 & 11_2 & 11_3 & 1_4  & 0_5  &      &              &                                    \\
0_6 & 1_5 & 26_4 & 66_3 & 26_2 & 1_1  & 0_0  & \quad\frac{1}{6!\Delta s} & M_{6,j}     \\
s_{j-6} & s_{j-5} & s_{j-4} & s_{j-3} & s_{j-2} & s_{j-1}  & s_{j}  &              &             \\
\end{matrix}
</script>


<p><strong>integration of $M_{r,j}$ </strong></p>

<script type="math/tex; mode=display">
\int M_{r,j} = \frac {1}{r}
</script>


<a name="roughness"></a>
<h2>roughness</h2>

<script type="math/tex; mode=display">
\begin{aligned}
& \left(\sum_{i=1}^n a_i\right)^2 = \sum_{k,l=1}^n a_k a_l \qquad \left(\sum_{i,j=1}^n a_{ij}\right)^2 = \sum_{k,l,p,q=1}^n a_{kl} a_{pq} \\
\Delta u_j&\left(\xi_1,\xi_2\right)=\sum^K_{k=1}\sum^K_{l=1} a_{jkl}\Phi_{kl}\left(\xi_1,\xi_2\right)=\sum^K_{k=1}\sum^K_{l=1} a_{jkl}N_k\left(\xi_1\right)N_l\left(\xi_2\right)\\
r&=\sum^2_{j=1}\int_s \frac{1}{n_3}\left[\left(\frac{1}{h^2_1}\frac{\partial^2\Delta u_j}{\partial \xi^2_1}\right)^2+2\left(\frac{1}{h_1 h_2}\frac{\partial^2\Delta u_j}{\partial\xi_1\partial\xi_2}\right)^2+\left(\frac{1}{h^2_2}\frac{\partial^2\Delta u_j}{\partial \xi^2_2}\right)^2\right]~d\xi_1d\xi_2 \\
&=\sum^2_{j=1}\sum^K_{k=1}\sum^L_{l=1}\sum^K_{p=1}\sum^L_{q=1}a_{jkl}R_{jklpq}a_{jpq} \\
R_{jklpq}&=\frac{1}{\overline{n}_3 \overline{h}^4_1}\int\frac{\partial^2N_k(s)}{\partial s^2}\frac{\partial^2N_p(s)}{\partial s^2}~ds\int N_l(s)N_q(s)~ds \\
&+ \frac{2}{\overline{n}_3 \overline{h}^2_1 \overline{h}^2_2}\int\frac{\partial N_k(s)}{\partial s}\frac{\partial N_p(s)}{\partial s}~ds\int\frac{\partial N_l(s)}{\partial s}\frac{\partial N_q(s)}{\partial s}~ds \\
&+\frac{1}{\overline{n}_3 \overline{h}^4_2}\int N_k(s)N_p(s)~ds\int\frac{\partial^2N_l(s)}{\partial s^2}\frac{\partial^2N_q(s)}{\partial s^2}~ds \\
&=\widetilde{R}_{klpq} \\
\text{with}  \\
h_i &= \sqrt{1+f_i}\qquad\left(i=1,2\right) \\
\text{in} & \text{ vector form }  \\
r&=\mathbf{a}^T\mathbf{G}\mathbf{a}
\text{ with } & \\
G_{IJ} &= R{jklpq} \\
I&=(j-1)KL+(k-1)L+l \\
J&=(j-1)KL+(p-1)L+q
\end{aligned} 
</script>


<p>suppose coordinate on fault then $f_1=f_2=0, h_1=h_2=1$</p>

<p>M_4,i 积分，微分，最大值，
M_4,j * M_4,j 积分微分</p>

<script type="math/tex; mode=display">
\begin{aligned}
&\left(s-s_{j-3}\right)\left(s_{j-1}-s\right)+\left(s_j-s\right)\left(s-s_{j-2}\right) \\
&=\left( \Delta s + \left( s- s_{j-2} \right) \right)\left( \Delta s - \left( s- s_{j-2} \right) \right) 
 +\left( \Delta s + \left( s_{j-1}- s \right) \right)\left( \Delta s - \left( s_{j-1}- s \right) \right)\\
&=\color{red}{\left( {\Delta s}^2 -\left( s-s_{j-2}\right)^2\right) 
 +\left( {\Delta s}^2 -\left( s_{j-1}-s\right)^2\right)} \\
&=\frac{3}{2}\Delta s^2 - 2\left(s-s_{j-1.5}\right)^2
\end{aligned}
</script>


<hr />

<p><strong>suppose:</strong>
errors $e$ to be Gaussian with</p>

<script type="math/tex; mode=display">
e \sim N(0,\sigma^2 \mathbf{E}) 
</script>


<p>$\sigma ^2 $ is unknow scale factor</p>

<p><strong>likelihood function:</strong></p>

<script type="math/tex; mode=display">
p\left( \mathbf{d} \mid \mathbf{a} \, ; \sigma^2 \right) = \left( 2 \pi \sigma^2 \right)^{-N/2} \| E \| ^{-1/2}  \times exp \left[ - \frac{1}{2\sigma^2} \left( \mathbf{d-Ha}\right)^T \mathbf{E}^{-1} \left( \mathbf{d-Ha} \right) \right]
</script>


<p>here $ || E || $ denotes the absolute value of the determinant of $ \mathbf{E} $</p>

<p><strong>prior information:</strong></p>

<script type="math/tex; mode=display">
p\left( \mathbf{a} \, ; \rho^2 \right) = \left( 2 \pi \rho^2 \right)^{-P/2} \| \Lambda_p \| ^{-1/2}   exp \left( - \frac{1}{2\rho^2} \mathbf{a}^T\mathbf{G} \mathbf{a} \right) 
</script>


<p><strong>posterior pdf</strong></p>

<script type="math/tex; mode=display">
\begin{equation}
P(\mathbf{a}\,;\,\sigma^2,\,\rho^2\,\mid\,\mathbf{d}) \propto P(\mathbf{d}\,\mid\,\mathbf{a}\,;\,\sigma^2)P(\mathbf{a}\,;\,\rho^2) 
\end{equation}
</script>


<p><strong>Marginal likelihood</strong></p>

<script type="math/tex; mode=display">
\begin{equation}
L(\sigma^2,\rho^2) = \int P(\mathbf{d}\,\mid\,\mathbf{a}\,;\,\sigma^2)P(\mathbf{a}\,;\,\rho^2) ~d\mathbf{a}
\end{equation}
</script>


<p><strong>Akaike Bayesian Information Criterion(ABIC)</strong></p>

<script type="math/tex; mode=display">
ABIC=(-2) log L(\sigma^2,\rho^2)
</script>


<hr />

<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
P(\mathbf{a};\sigma^2,\alpha^2 \mid \mathbf{d}) & = c(2\pi\sigma^2)^{-(N+P)/2}(\alpha^2)^{p/2}\|\mathbf{E}\|^{-1/2}\|\Lambda_p\|^{1/2} \\ 
                                                & \times exp\left[ -\frac{1}{2\sigma^2} s(\mathbf{a})\right] 
\end{aligned}
\end{equation}
</script>


<p>with</p>

<script type="math/tex; mode=display">
\begin{equation}
s(\mathbf{a}) = (\mathbf{d-Ha})^T\mathbf{E}^{-1}(\mathbf{d-Ha})+\alpha^2\mathbf{a^TGa}
\end{equation}
</script>


<p>for certain values of $\sigma ^2 $ and $\alpha ^2 $, minimizing $s(\mathbf{a}) $, $\frac{\partial s(\mathbf{a})}{\partial \mathbf{a}}=0 $</p>

<script type="math/tex; mode=display">
\begin{equation}
\mathbf{H^TE^{-1}}(\mathbf{d-Ha^\star})-\alpha^2\mathbf{Ga^\star=0}
\end{equation}
</script>


<p>the solution is:</p>

<script type="math/tex; mode=display">
\begin{equation}
\mathbf{a^\star=(H^TE^{-1}H}+\alpha^2\mathbf{G)^{-1}H^TE^{-1}d}
\end{equation}
</script>


<p>then, denoting</p>

<script type="math/tex; mode=display">
\begin{equation}
s(\mathbf{a^\star}) = (\mathbf{d-Ha^\star})^T\mathbf{E}^{-1}(\mathbf{d-Ha^\star})+\alpha^2 \mathbf{a^{\star T}Ga^\star}
\end{equation}
</script>


<p>rewrite $s(\mathbf{a}) $</p>

<script type="math/tex; mode=display">
\begin{equation}
s(\mathbf{a})=s(\mathbf{a^\star}) + (\mathbf{a-a^\star})^T(\mathbf{H^TE^{-1}H}+\alpha^2\mathbf{G})(\mathbf{a-a^\star})
\end{equation}
</script>


<p><strong><a href="http://en.wikipedia.org/wiki/Gaussian_integral">Gaussian integral</a></strong>
Suppose <strong>A</strong> is a symmetric positive-definite (hence invertible) $n \times n$ covariance matrix. Then,</p>

<script type="math/tex; mode=display">
\begin{equation}
\int_{-\infty}^\infty \exp\left(-\frac 1 2 x^{T} A x \right) \, d^nx=\sqrt{\frac{(2\pi)^n}{\det A}} 
\end{equation}
</script>


<p>subsitute equation (9) into equation (4), carrying out the integration of marginal likelihood equation (3) (see gaussian integral eq.(10)).</p>

<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
L&(\sigma^2,\rho^2)  = \int P(\mathbf{d}\,\mid\,\mathbf{a}\,;\,\sigma^2)P(\mathbf{a}\,;\,\rho^2) ~d\mathbf{a} \\
                   & = (2\pi\sigma^2)^{-(N+P)/2}(\alpha^2)^{p/2}\|\mathbf{E}\|^{-1/2}\|\Lambda_p\|^{1/2} \times 
                       exp\left[ -\frac{1}{2\sigma^2} s(\mathbf{a^\star}) \right]  \\
                   & \quad \times \int exp \left[ -\frac{1}{2}(\mathbf{a-a^\star})^T\frac{(\mathbf{H^TE^{-1}H}+\alpha^2\mathbf{G})}{\sigma^2}(\mathbf{a-a^\star}) \right] ~d(\mathbf{a-a^\star}) \\
                   & = (2\pi\sigma^2)^{-(N+P-M)/2}(\alpha^2)^{p/2}\|\mathbf{E}\|^{-1/2}\|\Lambda_p\|^{1/2} \| \mathbf{H^TE^{-1}H}+\alpha^2\mathbf{G} \|^{-1/2} \\
                   & \quad  \times exp\left[ -\frac{1}{2\sigma^2} s(\mathbf{a^\star}) \right]  \\
\end{aligned}
\end{equation}
</script>


<p>then</p>

<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
\frac{\partial L(\sigma^2,\alpha^2)}{\partial \sigma^2 } = 0  & \iff \frac{\partial \left( (\sigma^2)^{-(N+P-M)/2} exp \left[ \frac{s(\mathbf{a^\star})/2}{\sigma^2} \right]\right)}{\partial \sigma^2} \\
& \Rightarrow \sigma^2=\frac{s(\mathbf(a^\star))}{N+P-M}\\
\frac{\partial L(\sigma^2,\alpha^2)}{\partial \alpha^2 } = 0  & \quad \text{none-linear, resort to ABIC}
\end{aligned}
\end{equation}
</script>


<p>substitute equation(12) into ABIC then rewrite.</p>

<script type="math/tex; mode=display">
\begin{equation}
\begin{aligned}
ABIC(\alpha^2)= &-2log\left(\left( \frac{ 2\pi }{N+P-M}\color{red}{s(\mathbf{a^\star})} \right)^{\color{red}{-(N+P-M)/2}}\color{red}{(\alpha^2)^{p/2}} \right) \\
                &-2log\left( \|\mathbf{E}\|^{-1/2}\|\Lambda_p\|^{1/2} \color{red}{\| \mathbf{H^TE^{-1}H}+\alpha^2\mathbf{G} \|^{-1/2}} \right)\\
                &-2log\left( exp\left[ -\frac{1}{2} (N+P-M) \right] \right) \\
              = &(N+P-M) \log s(\mathbf{a^\star})-P \log \alpha^2 \\
                &+\log \| \mathbf{H^TE^{-1}H}+\alpha^2\mathbf{G} \|  + C
\end{aligned}
\end{equation}
</script>


<p><strong><a href="http://en.wikipedia.org/wiki/Matrix_calculus">Matrix Calculus</a></strong></p>

<table>
<thead>
<tr>
<th>Condition  </th>
<th> Expression    </th>
<th> Numerator layout </th>
<th> Denominator layout</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>A</strong> is not a<br/>function of <strong>x</strong>                        </td>
<td> $\frac{\partial \mathbf{x}^{\rm T}\mathbf{A}\mathbf{x}}{\partial \mathbf{x}}=$  </td>
<td> $\mathbf{x}^{\rm T}(\mathbf{A} + \mathbf{A}^{\rm T})$ </td>
<td> $(\mathbf{A} + \mathbf{A}^{\rm T})\mathbf{x}$</td>
</tr>
<tr>
<td><strong>A</strong> is not a<br/>function of <strong>x</strong><br/><strong>A</strong> is symmetric </td>
<td> $\frac{\partial \mathbf{x}^{\rm T}\mathbf{A}\mathbf{x}}{\partial \mathbf{x}} =$ </td>
<td> $2\mathbf{x}^{\rm T}\mathbf{A}$                       </td>
<td> $2\mathbf{A}\mathbf{x}$</td>
</tr>
</tbody>
</table>


<p><br/></p>

<p>to keep <strong>prior</strong> consistent with <strong>likelihood</strong>, hereby scale <strong>G</strong>, just give a qualitative analysis.</p>

<script type="math/tex; mode=display">
\begin{aligned}
& \large \mathbb{E} 
\left[ \left( \mathbf{d-Ha}\right)^T \frac{\mathbf{E}^{-1}}{\sigma^2} \left( \mathbf{d-Ha} \right) \right] = N,suppose\,\sigma^2=1 \\
& \large \mathbb{E}
\left(  \mathbf{a}^T \frac{\mathbf{G}^{\prime}}{\rho^2} \mathbf{a} \right)\, to\, be\, P\, with\, \rho^2=1  \\
& \large 
\Rightarrow  \mathbf{G}^{\prime} = \mathbf{G} * \frac{P}{ \bar{r} } \,with\,  \mathbf{ \bar{a} }^T \mathbf{G}  \mathbf{ \bar{a} } = \bar{r} \, and \,\, \bar{a}\,initial\,evaluation \end{aligned}
</script>


<hr />

<a name="other.notes.and.notions."></a>
<h2>other notes and notions.</h2>

<p>Consider a vector-valued function $\mathbb{R}^n\mapsto\mathbb{R}^m$  of order $m \times 1$, such that</p>

<script type="math/tex; mode=display">\mathbf{F}(x)=\left[f_1(x),\cdots,f_m(x)\right]^T</script>


<p>The diferentiation of such a vector-valued function $\mathbf{F}(\mathbf{x})$ by another vector <strong>x</strong> of order $n\times1$ is ambiguous
in the sense that the derivative</p>

<script type="math/tex; mode=display">\frac{\partial \mathbf{F(x)}}{\partial \mathbf{x}}</script>


<p>can either be expressed as an $m \times n$ matrix ( <strong>numerator</strong> layout convention ), or as an $n \times m$ matrix ( <strong>denominator</strong> layout convention ), such that we have</p>

<script type="math/tex; mode=display">
\frac{\partial \mathbf F (\mathbf X)} {\partial \mathbf{X}}=
\begin{bmatrix}
 \frac{\partial f_1(x)}{\partial x_1 } & \cdots & \frac{\partial f_1(x)}{\partial x_n}\\
 \vdots & \ddots & \vdots\\
 \frac{\partial f_m(x)}{\partial x_1 } & \cdots & \frac{\partial f_m(x)}{\partial x_n}\\
\end{bmatrix}
,\quad or \quad
\frac{\partial \mathbf F (\mathbf X)} {\partial \mathbf{X}}=
\begin{bmatrix}
 \frac{\partial f_1(x)}{\partial x_1 } & \cdots & \frac{\partial f_m(x)}{\partial x_1}\\
 \vdots & \ddots & \vdots\\
 \frac{\partial f_1(x)}{\partial x_n } & \cdots & \frac{\partial f_m(x)}{\partial x_n}\\
\end{bmatrix}
</script>


<a name="draft"></a>
<h2>draft</h2>

<div style="font-size: 100%;">$$
\definecolor{rgb}{RGB}{220,220,220}
\begin{aligned}
\Lambda_0 &= 
  \begin{cases}
    \quad \, s^3+6\Delta s s^2  + 12 \Delta s^2 s + 8 \Delta s^3  \color{rgb}{= (s+2\Delta s)^3}       &  [-2 \Delta s,  - \Delta s)\\
    -3 s^3 -6 \Delta s s^2 + 4 \Delta s^3                                                              &  [-\Delta s ,  0  \quad )\\  
    \enspace \,   3 s^3 -6 \Delta s s^2 + 4 \Delta s^3                                                 &  [ 0 \quad ,  \Delta s    )\\  
    \enspace  -s^3+6\Delta s s^2  - 12 \Delta s^2 s + 8 \Delta s^3 \color{rgb}{= (2\Delta s-s)^3}      &  [ \Delta s,  2 \Delta s]
  \end{cases} \\  \\
\Lambda_1 &= 
  \begin{cases}
    \enspace \, 3 s^2 + 12 \Delta s s + 12 \Delta s^2       &  \hspace{9.3em}  [-2 \Delta s,  - \Delta s)\\
    -9 s^2 -12 \Delta s s                                   &  \hspace{9.3em}  [-  \Delta s ,  0        )\\  
    \enspace \,   9 s^2 -12 \Delta s s                      &  \hspace{9.3em}  [  0 ,  \Delta s         )\\  
    -3 s^2 +12 \Delta s s - 12 \Delta s^2                   &  \hspace{9.3em}  [ \Delta s,  2 \Delta s)
  \end{cases} \\ \\  
\Lambda_2 &= 
  \begin{cases}
    \enspace \, 6 s \enspace + 12 \Delta s      & \hspace{13.6em} [-2 \Delta s,  - \Delta s)\\
    -18 s -12 \Delta s                          & \hspace{13.6em} [-  \Delta s ,  0        )\\  
    \enspace \,   18 s -12 \Delta s             & \hspace{13.6em} [  0 ,  \Delta s         )\\  
    -6 s \enspace +12 \Delta s                  & \hspace{13.6em} [ \Delta s,  2 \Delta s  )
  \end{cases} \\  
\end{aligned}
$$</div>




<script type="math/tex; mode=display">
\begin{aligned}
~&\\
\Lambda_0 &= \left\{
\begin{array}{lllll} 
    \quad \, \mathbf{s}^3+6\Delta s \mathbf{s}^2  + 12 \Delta s^2 \mathbf{s} + 8 \Delta s^3  \color{rgb}{= (s+2\Delta s)^3}     
    & ~ 
    & ~ 
    & ~ 
    &  [-2\Delta s ,  - \Delta s) \\
  
    -3 s^3 -6 \Delta s s^2 + 4 \Delta s^3   
    &  \quad \, s^3+ 3 \Delta s s^2 + 3 \Delta s^2 s + \Delta s^3  \color{rgb}{=(s+\Delta s)^3}
    &  ~
    &  ~   
    &  [- \Delta s ,  0         ) \\  

      \quad 3 s^3 - 6 \Delta s s^2 + 4 \Delta s^3    
    & -3 s^3 + 3 \Delta s s^2 + 3 \Delta s^2 s + \Delta s^3   
    & \quad \, s^3  
    & ~  
    &  [0          ,    \Delta s) \\  

        -s^3 +  6 \Delta s s^2 - 12 \Delta s^2 s + 8 \Delta s^3  \color{rgb}{= (2\Delta s-s)^3}   
    & ~3 s^3 - 15 \Delta s s^2 + 21 \Delta s^2 s - 5 \Delta s^3
    & -3 s^3 + 12 \Delta s s^2 - 12 \Delta s^2 s + 4 \Delta s^3
    & \quad \,  s^3 -  3 \Delta s s^2 +  3 \Delta s^2 s -   \Delta s^3  \color{rgb}{=(s-\Delta s)^3}
    &  [  \Delta s ,  2 \Delta s) \\

    ~
    &  -s^3 +  9 \Delta s s^2 - 27 \Delta s^2 s  + 27\Delta s^3 \color{rgb}{=(3\Delta s-s)^3} 
    &  3 s^3 - 24 \Delta s s^2 + 60 \Delta s^2 s  - 44\Delta s^3 
    & -3 s^3 + 21 \Delta s s^2 - 45 \Delta s^2 s  + 31\Delta s^3 
    &  [2 \Delta s ,  3 \Delta s) \\

    ~
    & ~
    & - s^3 + 12 \Delta s s^2 -  48 \Delta s^2 s +  64\Delta s^3 \color{rgb}{=(4\Delta s-s)^3}
    & 3 s^3 - 33 \Delta s s^2 + 117 \Delta s^2 s - 131\Delta s^3
    &  [3 \Delta s ,  4 \Delta s) \\

    ~
    & ~
    & ~
    & - s^3 + 15 \Delta s s^2 -  75 \Delta s^2 s + 125\Delta s^3 \color{rgb}{=(5\Delta s-s)^3}
    &  [4 \Delta s ,  5 \Delta s)  
\end{array}\right. \\


\Lambda_1 &= \left\{
\begin{array}{lllll} 
    3 s^2 + 12 \Delta s s + 12 \Delta s^2   \color{rgb}{= 3(s+2\Delta s)^2}   
    & ~ 
    & ~ 
    & ~ 
    &  [-2\Delta s ,  - \Delta s) \\
  
     -9 s^2 -12 \Delta s s    
    & 3 s^2 + 6 \Delta s s + 3 \Delta s^2 \color{rgb}{=3(s+\Delta s)^2} 
    &  ~
    &  ~   
    &  [- \Delta s ,  0         ) \\  

       9 s^2 - 12 \Delta s s   
    & -9 s^2 + 6\Delta s s + 3 \Delta s^2    
    &  3 s^2  
    & ~  
    &  [0          ,    \Delta s) \\  

       -3 s^2 + 12 \Delta s s - 12 \Delta s^2 \color{rgb}{=-3(2\Delta s -s)^2}    
    &   9 s^2 - 30 \Delta s s + 21 \Delta s^2
    &  -9 s^2 + 24 \Delta s s - 12 \Delta s^2
    &   3 s^2 -  6 \Delta s s +  3 \Delta s^2 \color{rgb}{=3(s-\Delta s)^2}
    &  [  \Delta s ,  2 \Delta s) \\

    ~
    &  -3s^2+18\Delta s s - 27 \Delta s^2  \color{rgb}{=-3(3\Delta s -s)^2} 
    &   9s^2-48\Delta s s + 60 \Delta s^2
    &  -9s^2+42\Delta s s - 45 \Delta s^2
    &  [2 \Delta s ,  3 \Delta s) \\

    ~
    & ~
    &  -3s^2+24\Delta s s - 48  \Delta s^2 \color{rgb}{=-3(4\Delta s-s)^2} 
    &   9s^2-66\Delta s s + 117 \Delta s^2
    &  [3 \Delta s ,  4 \Delta s) \\

    ~
    & ~
    & ~
    &  -3s^2+30\Delta s - 75 \Delta s^2 \color{rgb}{=-3(5\Delta s-s)^2}
    &  [4 \Delta s ,  5 \Delta s)  
\end{array}\right. \\


\Lambda_2 &= \left\{
\begin{array}{lllll} 
    6 s + 12 \Delta s    
    & ~ 
    & ~ 
    & ~ 
    &  [-2\Delta s ,  - \Delta s) \\
  
     -18s - 12 \Delta s     
    &  6s +  6 \Delta s  
    &  ~
    &  ~   
    &  [- \Delta s ,  0         ) \\  

       18 s - 12 \Delta s   
    & -18 s +  6 \Delta s    
    &   6 s  
    & ~  
    &  [0          ,    \Delta s) \\  

       -6 s + 12 \Delta s \qquad    
    &  18 s - 30 \Delta s \qquad
    & -18 s + 24 \Delta s \qquad
    &   6 s -  6 \Delta s \qquad
    &  [  \Delta s ,  2 \Delta s) \\

    ~
    &  -6s + 18 \Delta s 
    &  18s - 48 \Delta s
    & -18s + 42 \Delta s
    &  [2 \Delta s ,  3 \Delta s) \\

    ~
    & ~
    &  -6s + 24 \Delta s 
    &  18s - 66 \Delta s
    &  [3 \Delta s ,  4 \Delta s) \\

    ~
    & ~
    & ~
    &  -6s + 30 \Delta s
    &  [4 \Delta s ,  5 \Delta s)  
\end{array}\right. \\

~&\\
\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
\int^0_{-\Delta s}          &(-3s^3-6\Delta s s^2 + 4\Delta s^3)( s^3+3\Delta s s^2 + 3\Delta s^2 s + \Delta s^3)~ds \\
                            &=\int^0_{-\Delta s}(-3s^6-15\Delta s s^5 -27\Delta s^2 s^4 -17\Delta s^3 s^3 + 6\Delta s^4 s^2 +12\Delta s^5 s + 4 \Delta s^6)~ds\\
                            &=\frac{129}{140}\Delta s^7\\
\int^{\Delta s}_0           &( 3s^3-6\Delta s s^2 + 4\Delta s^3)(-s^3+3\Delta s s^2 + 3\Delta s^2 s + \Delta s^3)~ds \\
                            &=\int^{\Delta s}_0(-3 s^6 + 15 s^5 \Delta s -9s^4\Delta s^2-19s^3\Delta s^3+6s^2\Delta s^4+12s\Delta s^5 +4\Delta s^6)~ds \\
                            &=7\frac{73}{140}\Delta s^7\\
\int^{2\Delta s}_{\Delta s} &( -s^3+6\Delta s s^2 -12\Delta s^2 s + 8\Delta s^3)(3s^3-15\Delta s s^2+21\Delta s^2 s -5\Delta s^3)~ds \\
                            &=\int^{2\Delta s}_{\Delta s}(-3s^6+33s^5\Delta s-147s^4\Delta s^2+335s^3\Delta s^3-402s^2\Delta s^4+228s\Delta s^5-40\Delta s^6)~ds\\
                            &=(1+\frac{3}{4}-\frac{3}{7}-\frac{2}{5})\Delta s^7=\frac{129}{140}\Delta s^7\\

& \vdots\\

\int^{\Delta s}_0           &(3s^3-6\Delta s s^2 + 4\Delta s^3) s^3 ~ ds = \frac{3}{7}\Delta s^7 \\
\int^{2\Delta s}_{\Delta s} &(-s^3+6\Delta s s^2 -12\Delta s^2 s + 8\Delta s^3 )(-3s^3+12\Delta s s^2 -12\Delta s^2 s + 4\Delta s^3)~ds \\
                            &=\int^{2\Delta s}_{\Delta s} (3s^6-30\Delta s s^5+120 \Delta s^2 s^4 -244\Delta s^3 s^3 +264\Delta s^4 s^2-144\Delta s^5 s + 32 \Delta s^6) ~ds\\
                            &=\frac{3}{7}\Delta s^7 \\
& \vdots\\

\int^{2\Delta s}_{\Delta s} &(-s^3+6\Delta s s^2 -12\Delta s^2 s + 8\Delta s^3 )  (s^3-3\Delta s s^2+3\Delta s^2 s - \Delta s^3)  ~ds \\
                            &=\int^{2\Delta s}_{\Delta s}(2\Delta s-s)^3(s-\Delta s)^3~ds \overset{s=s-\Delta s}{\iff}\int^{\Delta s}_{0}(\Delta s - s)^3s^3ds\\
                            &=\int^{\Delta s}_{0}(-s^6+3\Delta s s^5-3\Delta s^2 s^4 + \Delta s^3 s^3)~ds=\frac{1}{140}\Delta s^7
\end{aligned}
</script>




<script type="math/tex; mode=display">
\begin{aligned}
\Gamma_0 &= 
\begin{bmatrix}
   \frac{1}{7}                                   & ~                             & ~                             & ~              \\ \\
   \frac{297}{35}\color{rgb}{=\frac{1188}{140}}  & \frac{129}{140}               & ~                             & ~              \\ \\
   \frac{297}{35}\color{rgb}{=\frac{1188}{140}}  & \frac{1053}{140}              &  \frac{3}{7}                  & ~              \\ \\
   \frac{1}{7}                                   & \frac{129}{140}               &  \frac{3}{7}                  & \quad \frac{1}{140} \\ \\
   \color{red}{\frac{604}{35}}                   & \color{red}{\frac{1311}{140}} &  \color{red}{\frac{6}{7}}     & \color{red}{\frac{1}{140}}     
\end{bmatrix} \Delta s^7 \\
\Gamma_1 &= 
\begin{bmatrix}
   \frac{9}{5}   & ~                  & ~               & ~                    \\ \\
   \frac{51}{5}  & \frac{21}{10}      & ~               & ~                    \\ \\
   \frac{51}{5}  & \frac{-87}{10}     &  \frac{-18}{5}   & ~                    \\ \\
   \frac{9}{5}   & \frac{21}{10}      &  \frac{-18}{5}   & \quad \frac{-3}{10}  
\end{bmatrix} \Delta s^5 \\
\Gamma_2 &= 
\begin{bmatrix}
   12   &  ~     &  ~   & ~   \\ \\
   36   & -18    &  ~   & ~   \\ \\
   36   & -18    &  0   & ~   \\ \\
   12   & -18    &  0   &  6  
\end{bmatrix} \Delta s^3 \\
\end{aligned}
</script>


<hr />

<ul>
<li>$ M_k  \sim Length^{-1}        $</li>
<li>$ N_k \sim 1 ; \int N_k N_k~ds \sim Length ; \int \int N_k N_q~d\xi~d\xi=area $</li>
<li>$ \int N_k~ds = \Delta s       $</li>
<li>$ \int M_k~ds = \frac{1}{n}    $</li>
<li>$ a_{kl} \sim Length           $</li>
<li>$ R_{jklpq} \sim Length^{-2}   $</li>
<li>$ r {\sim a^{T}} \mathbf{R} a \sim 1 $</li>
</ul>


<div>$$
\begin{aligned}
\Delta u(\xi_1,\xi_2)&=\sum_{k=1}^K\sum_{l=1}^La_{kl}N_k(\xi_1)N_l(\xi_2) \\
\mu\oint_s\Delta u(\xi_1,\xi_2)~ds&=\mu\sum_{k=1}^K\sum_{l=1}^L\iint a_{kl}~4\Delta\xi_1M_{4,k}(\xi_1)4\Delta\xi_2M_{4,l}(\xi_2)~d\xi_1d\xi_2\\
&=\mu\sum_{k=1}^K\sum_{l=1}^L\Delta\xi_1\Delta\xi_2a_{kl}=\mu\sum_{k=1}^K\sum_{l=1}^L\overline{\Delta u}\Delta\xi_1\Delta\xi_2
\end{aligned}
$$</div>


<hr />

<a name="STATIC.DATA"></a>
<h2>STATIC DATA</h2>

<div>$$
\begin{aligned}

u(\mathbf{\vec{x}})   &=\sum_{j=1}^2\oint_sG_j(\mathbf{\vec{x},\vec{\xi}})\Delta u_j(\mathbf{\vec{\xi}})~ds(\mathbf{\vec{\xi}})     \\
\Delta u_j(\xi_1,\xi_2) &=\sum_{k=1}^k\sum_{l=1}^La_{jkl}\Phi_{kl}(\xi_1,\xi_2)       \color{rgb}  \impliedby \Phi_{kl}(\xi_1,\xi_2)=N_k(\xi_1)N_l(\xi_2) \\
                      &=\sum_{k=1}^k\sum_{l=1}^La_{jkl}N_k(\xi_1)N_l(\xi_2)       \color{rgb}  \impliedby  N_j(s)=4\Delta s M_{4,j+2}(s) \\ 
                      &=\sum_{k=1}^k\sum_{l=1}^La_{jkl}4\Delta\xi_1M_{4,k+2}(\xi_1)4\Delta\xi_2M_{4,l+2}(\xi_2)   \\
u(\mathbf{\vec{x}})   &=\color{blue}{16\Delta\xi_1\Delta\xi_2\sum_{j=1}^2\sum_{k=1}^k\sum_{l=1}^L\iint_sG_j(\mathbf{\vec{x},\xi_1,\xi_2}) M_{4,k+2}(\xi_1)M_{4,l+2}(\xi_2)   ~d\xi_1d\xi_2 } ~\color{red}{a_{jkl}} \\
\end{aligned}
$$</div>


<p>if considering uncertain of Green Function( $\delta G $ ), then follows the same formulation derivation with seismic data.</p>

<a name="roughness.scheme"></a>
<h2>roughness scheme</h2>

<p><strong>scheme 1: T.Yabuki(1992): </strong>  <a href="#roughness"><i class="fa fa-external-link"></i></a></p>

<script type="math/tex; mode=display">
r=\sum^2_{j=1}\int_s \frac{1}{n_3}\left[\left(\frac{1}{h^2_1}\frac{\partial^2\Delta u_j}{\partial \xi^2_1}\right)^2+2\left(\frac{1}{h_1 h_2}\frac{\partial^2\Delta u_j}{\partial\xi_1\partial\xi_2}\right)^2+\left(\frac{1}{h^2_2}\frac{\partial^2\Delta u_j}{\partial \xi^2_2}\right)^2\right]~d\xi_1d\xi_2 \\
</script>


<p><strong>scheme 2: Yukitoshi Fukahata(2004)</strong></p>

<div>$$
\begin{equation}
\begin{aligned}
 & \dot D (\xi,\tau) =\sum_{k=1}^K\sum_{l=1}^La_{kl}X_k(\xi)T_l(\tau) \\
r_1&=\int_T\int_{\Sigma}[\partial^2 \dot D(\xi,\tau)/\partial\xi^2]^2 ~d\xi d\tau \\
   &=\int_T\int_{\Sigma}\left[\sum_{k=1}^K\sum_{l=1}^La_{kl} \frac{\partial^2 X_k(\xi)}{\partial\xi^2} T_l(\tau)\right]^2 ~d\xi d\tau \\
   &=\int_T\int_{\Sigma}\sum_{k=1}^K\sum_{l=1}^L\sum_{p=1}^K\sum_{q=1}^L\left[a_{kl} \frac{\partial^2 X_k(\xi)}{\partial\xi^2} T_l(\tau)a_{pq} \frac{\partial^2 X_p(\xi)}{\partial\xi^2} T_q(\tau)\right] ~d\xi d\tau \\
   &=\sum_{k=1}^K\sum_{l=1}^L\sum_{p=1}^K\sum_{q=1}^L a_{kl} ~ \bbox[#eee]{ {\color{red} \int_{\Sigma} \frac{\partial^2 X_k(\xi)}{\partial\xi^2} \frac{\partial^2 X_p(\xi)}{\partial\xi^2}~d\xi} \int_T T_l(\tau) T_q(\tau) ~d\tau }  ~ a_{pq}\\
   &=\sum_{k=1}^K\sum_{l=1}^L\sum_{p=1}^K\sum_{q=1}^L a_{kl}~G_{klpq}^1~a_{pq} = \mathbf{a}^T\mathbf{G}_1\mathbf{a}  \\
r_2&=\int_T\int_{\Sigma}[\partial  \dot D(\xi,\tau)/\partial\tau ]^2 ~d\xi d\tau \\
   &=\sum_{k=1}^K\sum_{l=1}^L\sum_{p=1}^K\sum_{q=1}^L a_{kl}~ \bbox[#eee]{ \int_\Sigma X_k(\xi)X_p(\xi)~d\xi\int_T\frac{\partial T_l(\tau)}{\partial\tau}\frac{\partial T_q(\tau)}{\partial\tau}~d\tau  } ~a_{pq} \\
   &=\sum_{k=1}^K\sum_{l=1}^L\sum_{p=1}^K\sum_{q=1}^L a_{kl}~G_{klpq}^2~a_{pq} = \mathbf{a}^T\mathbf{G}_2\mathbf{a}  \\
\end{aligned}
\end{equation}
$$</div>


<p>Note:</p>

<ul>
<li>here omit slip-direction component.</li>
<li>base function of time: triangle. so $r_2$ adopt first derivative</li>
<li>the red part we adopt bilinear B-splines in $\xi_1$, $\xi_2$ direction, can be replace by scheme1.</li>
</ul>


<p><strong>scheme 3:  </strong></p>

<p><em>Yuji Yagi(2008)</em></p>

<div>$$
\begin{equation}
\begin{aligned}
\dot{D}_q(t,\xi)  =  \sum_{k=1}^K\sum_{l=1}^La_{klq}X_k(\xi)T_l(t)&+\delta\dot{D}_q(t,\xi)\\
\nabla^2 \int a_{klq} X_k(\xi)T_l(t)~dt+e_s               =0  \quad &\mathbf{S_1a+e_s=0} \qquad \mathbf{G_1=S_1^tS_1} \\
\frac{\partial^2}{\partial t^2}a_{klq}X_k(\xi)T_l(t)+e_t  =0  \quad &\mathbf{S_2a+e_t=0} \qquad \mathbf{G_2=S_2^tS_2} \\
\end{aligned}
\end{equation}
$$</div>


<p><em>Yuji Yagi(2011)</em></p>

<div>$$
\begin{equation}
\begin{aligned}
\dot{D}_q^0(t,\xi)  \cong  \sum_{k=1}^K\sum_{l=1}^L&a_{qkl}X_k(\xi)T_l(t-t_k)  \\
\nabla^2 \dot{D}(t,\xi)+e_s                       =0 \quad & \mathbf{S_1a+e_s=0} \qquad \mathbf{G_1=S_1^tS_1} \\
\frac{\partial^2}{\partial t^2}\dot{D}(t,\xi)+e_t =0 \quad & \mathbf{S_2a+e_t=0} \qquad \mathbf{G_2=S_2^tS_2} \\
\end{aligned}
\end{equation}
$$</div>


<p>Note:</p>

<ul>
<li>here use second dirative for time, so the base funcion for time is also expressed by B-spine.</li>
</ul>


<p><strong>scheme</strong></p>

<ul>
<li>both time and space base function represented by B-spine function with second order differentiability, (bilinear B-spine for space)</li>
<li>apply $\int_T$ and $\int_\Sigma$ to abtain a scalar value.</li>
<li>apply $[\cdots]^2$ to abtain this form: $\mathbf{a}^T\mathbf{G}\mathbf{a}$</li>
<li>compare scheme 1,2 with 3:  $ {\left[{\nabla}^2\dot{D}\right]}^{2} \iff \mathbf{a}^T\mathbf{G}\mathbf{a} \iff S^{T} S $</li>
<li>conbine scheme 1,2,3 then:</li>
</ul>


<div style="text-align:left">$$
\begin{equation}
\begin{aligned}
r_1  =       & \int_T\int_{\Sigma}\left[\partial^2 \dot D(\xi,\tau)/\partial\xi^2\right]^2 ~d\xi d\tau \\
     \iff    & \int_T\int_{\Sigma}\left[\nabla^2 \dot D(\xi,\tau)\right]^2 ~d\xi d\tau \\
     =       & \int_T\int_{\Sigma}\left[\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_1^2}
                                       +\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_2^2}\right]^2 ~d\xi d\tau \\
     =       & \int_T\int_{\Sigma}\left[\left(\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_1^2}\right)^2
                                            +2\frac{\partial^2 \dot D }{\partial \xi_1^2}\frac{\partial^2 \dot D }{\partial \xi_2^2}
                                       +\left(\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_2^2}\right)^2
                                 \right] ~d\xi d\tau \\
     \iff    & \int_T\int_{\Sigma}\left[\left(\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_1^2}\right)^2
                                      +2\left(\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_1 \partial \xi_2}\right)^2
                                       +\left(\frac{\partial^2 \dot D(\xi,\tau) }{\partial \xi_2^2}\right)^2
                                 \right] ~d\xi d\tau \\


\end{aligned}
\end{equation}
$$</div>




      
      <footer>
        <p>
          本作品由 <a href="mailto:wzjwzj@mail.ustc.edu.cn" rel="nofollow">孤月谁明</a> 创作，采用
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="查看协议详细信息" target="_blank">CC BY-NC-SA 3.0 许可协议</a>
          进行许可。
        </p>
      </footer>
      
    </section>

  </article>
</section>

<section>

  
  <ul class="tag-box inline">
    <li><i class="fa fa-folder-open fa-4"></i></li>
    
    


  
     
    	<li><a href="/categories.html#uncategorized-ref" rel="nofollow">
    		uncategorized <span>8</span>
    	</a></li>
    
  


  </ul>
  

  
  <ul class="tag-box inline">
    <li><i class="fa fa-tags fa-4"></i></li>
    
    


  
     
    	<li><a href="/tags.html#info-ref" rel="nofollow">info <span>11</span></a></li>
    
  



  </ul>
  

  <div class="pagination">
    <ul>
      
      <li class="prev"><a href="/blog/2014/02/25/chinese-food-recipe" title="菜单">&larr; 上一篇</a></li>
      
      <li><a href="/archive.html" rel="nofollow">文章列表</a></li>
      
      <li class="next"><a href="/blog/2014/04/16/abic0" title="ABIC0">下一篇 &rarr;</a></li>
      
    </ul>
  </div>

</section>

<section id="comments">
  


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'guyueshuiming'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var dsc = document.createElement('script'); dsc.type = 'text/javascript'; dsc.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        dsc.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(dsc);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</section>


        </div>
      </div>
      
      <div id="back-top">
  <a href="#top" title="回到顶部"></a>
</div>
<script type="text/javascript">
$("#back-top").hide();
$(document).ready(function () {
  $(window).scroll(function () {
    if ($(this).scrollTop() > 100) {
      $('#back-top').fadeIn();
    } else {
      $('#back-top').fadeOut();
    }
  });
  $('#back-top a').click(function () {
    $('body,html').animate({
      scrollTop: 0
    }, 800);
    return false;
  });
});
</script>

    </section>

    <footer id="bottom">
      <p align="center">&copy; 2014 guyueshuiming
        with help from <a href="http://jekyllbootstrap.com" target="_blank" rel="nofollow" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
        and <a href="http://twitter.github.com/bootstrap/" target="_blank" rel="nofollow">Twitter Bootstrap</a>
      </p>
    </footer>
  </div>



  <script type="text/javascript" src="/assets/themes/twitter/js/jquery.toc.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function(){
       $('.toc').toc({
        'selectors': 'h2,h3', 
        'container': 'article',
       });
       $('#toc_wraper').show();
    });
  </script>


<!-- fixed toc or fix container -->

<script type="text/javascript">
   $(document).ready(function(){
   
      var f= $('#toc_wraper').parent() ; 
   

   f.css({ 'z-index':'99999'});
   var h= f.height();
   var position = f.offset();

   $(window).scroll(function() {
      if($(window).scrollTop() > position.top ) {
         v = 129 + h - $(window).innerHeight()  ;
         u = $( document ).height()-$(window).scrollTop()-$(window).innerHeight();
         if( v > 0 && u < h && u < v ) {
            f.css('position','fixed').css('top',-(u+v));
         } else {
            f.css('position','fixed').css('top', -1);
         }
      } else {
       f.css('position','static');
      }
   });
   if(matchMedia) {
     var mq = matchMedia('(max-width: 999px)');
     mq.addListener(function(mql) {
       if (!mql.matches) {
         position = f.offset();
       }
     });
   }
});
</script>

<script type="text/javascript">
  $(document).ready(function() {
    $("table.highlighttable").wrap('<div style="overflow:auto;border: 1px solid rgba(0,0,0,0.15);border-radius: 4px;"></div>');
    /*$('pre:not(table.highlighttable pre, div.highlight pre, div.gist pre, pre.plain)').addClass('prettyprint linenums').attr('style', 'overflow:auto'); 
      $.getScript('/assets/prettify/prettify.js',function(){ prettyPrint();});*/
    $("#icon-resize").click(function(){
      if($(this).hasClass("fa-expand")){
         $(this).removeClass("fa-expand");
         $(this).addClass("fa-compress");
	 $("#wrap").css("width","100%");
      } else{
         $(this).removeClass("fa-compress");
         $(this).addClass("fa-expand");
	 $("#wrap").css("width","1000px");
      }
     });
     	
  });
</script>

<script src="/assets/themes/twitter/js/hc.js" type="text/javascript"></script>
<!--script src="http://dict.cn/hc/" type="text/javascript"></script-->
<script type="text/javascript">
dictInit();
</script>
</body>
</html>

